<template name="jobLogs">
  <div class="row">
    <div class="col s6">
      <h5>Logs</h5>
    </div>
    <div class="col s6 right-align">
      <h6><a class="waves-effect waves-light btn" href="/job/new">new job</a></h6>
    </div>
  </div>
  <div class="row">
    <div class="col s12">
      <ul class="collapsible" data-collapsible="expandable">
        <li>
          <div class="collapsible-header">
            <div class="chip">server</div>
            {{#if (compareStatus job 'ready')}}
              <div class="progress">
                <div class="indeterminate"></div>
              </div>
            {{else}}
              {{#if (compareStatus job 'running')}}
                <div class="progress">
                  <div class="indeterminate preloader-running"></div>
                </div>
              {{/if}}
            {{/if}}
          </div>
          <div class="collapsible-body">
            <div class="blue-grey lighten-4">
              <pre class="log-lines">{{#each (logs 'undefined')}}{{ isoTime time }} {{{ message }}}<br>{{/each}}</pre>
            </div>
          </div>
        </li>

        {{#each _id in jobNodes}}
          {{#let nodeStatus=(status _id)}}
            <li>
              <div class="collapsible-header {{optimizationClass nodeStatus}}">
                <div class="chip">{{nodeVersion(_id)}}</div>
                {{#if nodeStatus}}
                  <div class="right">
                    {{nodeStatus.status}}
                  </div>
                {{ else }}
                  {{#if (compareStatus job 'ready')}}
                    <div class="progress">
                      <div class="indeterminate"></div>
                    </div>
                  {{else}}
                    {{#if (compareStatus job 'running')}}
                      <div class="progress">
                        <div class="indeterminate preloader-running"></div>
                      </div>
                    {{/if}}
                  {{/if}}
                {{/if}}
              </div>
              <div class="collapsible-body" id="node-log-{{_id}}">
                <div class="blue-grey lighten-4">
                  <pre class="log-lines">{{#each (logs _id)}}{{{ message }}}<br>{{/each}}</pre>
                </div>
              </div>
            </li>
          {{/let}}
        {{else}}
          Please select at least one node version.
        {{/each}}
      </ul>
    </div>
  </div>
</template>
